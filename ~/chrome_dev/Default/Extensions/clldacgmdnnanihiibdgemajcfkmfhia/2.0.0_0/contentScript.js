(()=>{var e,t;!async function(){$(document).keyup((function(e){if(27==e.keyCode){document.body.style.cursor="auto";let e=document.getElementById("mycanvas");e&&e.parentNode.removeChild(e);let t=document.getElementById("mydiv");t&&t.parentNode.removeChild(t)}})),chrome.runtime.onMessage.addListener((async function(o,i,d){if("remove"==o.message)console.log("Yes removed"),function(){let e=document.getElementById("mycanvas");e&&e.parentNode.removeChild(e);let t=document.getElementById("mydiv");t&&t.parentNode.removeChild(t)}();else if("init"==o.message){document.body.style.cursor="url("+chrome.runtime.getURL("plus.png")+") 16 16,crosshair";let r=document.createElement("div");r.setAttribute("id","mydiv");let a=document.createElement("div");a.setAttribute("id","divhead");let l=document.createElement("button");l.setAttribute("id","mybtn"),l.innerText="X",l.onclick=function(){let e=document.getElementById("mydiv");e&&e.parentNode.removeChild(e)},a.appendChild(l),r.appendChild(a);let m=document.createElement("div");m.setAttribute("id","divfoot"),r.appendChild(m);let s=document.createElement("div");s.setAttribute("id","hexWrapper");let u=document.createElement("input");u.setAttribute("id","hexinput");let p=document.createElement("div");p.setAttribute("id","hexCopyWrapper"),p.onclick=()=>{var e=document.getElementById("hexinput");e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value)};let h=document.createElement("img");h.setAttribute("id","hexCopyImage"),h.src=chrome.runtime.getURL("copy.png"),p.appendChild(h),s.appendChild(u),s.appendChild(p);let g=document.createElement("div");g.setAttribute("id","rgbWrapper");let v=document.createElement("input");v.setAttribute("id","rgbinput");let b=document.createElement("div");b.setAttribute("id","rgbCopyWrapper"),b.onclick=()=>{var e=document.getElementById("rgbinput");e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value)};let C=document.createElement("img");C.setAttribute("id","rgbCopyImage"),C.src=chrome.runtime.getURL("copy.png"),b.appendChild(C),g.appendChild(v),g.appendChild(b),m.appendChild(s),m.appendChild(g);const f={cols:40,rows:40,width:200,height:200};window.addEventListener("scroll",(function(){document.body.style.cursor="auto";let e=document.getElementById("mycanvas");e&&e.parentNode.removeChild(e);let t=document.getElementById("mydiv");t&&t.parentNode.removeChild(t)}));let E=function(e){let t=document.createElement("CANVAS"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,t.style.border="1px solid white",n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1,n.globalCompositeOperation="source-over",t}(f);E.setAttribute("id","innerCanvas"),E.width=200,E.height=200;let w=E.getContext("2d");r.appendChild(E),document.body.addEventListener("click",(function(){let n=document.getElementById("mycanvas");n&&n.parentNode.removeChild(n),r&&r.childElementCount>2&&r.removeChild(E),r.style.height="100px",a.style.display="flex",m.style.display="flex",u.value=e,v.value=t,document.body.style.cursor="auto",chrome.storage.sync.get("colors",(({colors:t})=>{let n=t||[];n&&n.length>7&&n.splice(0,1),n.includes(e)||n.push(e),chrome.storage.sync.set({colors:n})})),$(document).unbind("mousemove")}));let I=document.createElement("canvas");I.setAttribute("id","mycanvas"),I.width=window.innerWidth,I.height=window.innerHeight;let A=I.getContext("2d"),L=new Image;L.onload=function(){A.drawImage(L,0,0,I.width,I.height)},L.src=o.screenshot,document.body.appendChild(I),document.body.appendChild(r);let k=window.innerWidth,T=window.innerHeight;function c(e,t){var n=t.getBoundingClientRect(),o=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,i=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,d=n.left+i,c=n.top+o;return x=e.pageX-d,y=e.pageY-c,{x,y}}$(document).on("mousemove",(function(e){let t=e.clientX,n=e.clientY;t>k-220||n>T-220||$("#mydiv").css({left:e.clientX,top:e.clientY})})),$("#mycanvas").mousemove((async function(o){!function(e){if(e.offsetParent)do{e.offsetLeft,e.offsetTop}while(e=e.offsetParent)}(this);var{x:i,y:d}=c(o,this),a=this.getContext("2d"),l=a.getImageData(i,d,1,1).data;t=`rgb(${l[0]},${l[1]},${l[2]})`,e="#"+("000000"+function(e,t,n){if(e>255||t>255||n>255)throw"Invalid color component";return(e<<16|t<<8|n).toString(16)}(l[0],l[1],l[2])).slice(-6),r.style.backgroundColor=e,n(w,i,d,a)}))}}));const n=(e,t,n,o)=>{let i=o.getImageData(t-20,n-20,40,40);(o=document.createElement("canvas")).width=40,o.height=40,o.getContext("2d").putImageData(i,0,0,0,0,40,40);let d=new Image;d.onload=function(){e.drawImage(d,0,0,200,200),e.fillRect(innerCanvas.width/2,innerCanvas.height/2,5,5)},d.src=o.toDataURL()};CanvasRenderingContext2D.prototype.roundRect=function(e,t,n,o,i){return n<2*i&&(i=n/2),o<2*i&&(i=o/2),this.beginPath(),this.moveTo(e+i,t),this.arcTo(e+n,t,e+n,t+o,i),this.arcTo(e+n,t+o,e,t+o,i),this.arcTo(e,t+o,e,t,i),this.arcTo(e,t,e+n,t,i),this.closePath(),this}}();const n=async()=>new Promise(((e,t)=>{document.querySelector(".cp-wrapper")&&$(".cp-wrapper").remove(),e()}));chrome.runtime.onMessage.addListener((async function(e,t,o){"openPopup"==e.message&&(n(),(()=>{let e=document.createElement("div");e.setAttribute("class","cp-wrapper"),e.addEventListener("click",(()=>{})),e.innerHTML='<div class="cp-container">\n        <div class="cp-header">\n            <img class="cp-image"/>\n            <button class="cp-pickup"><img class="cp-pickimage"/> Pick</button>\n        </div>\n        <div class="cp-body">\n        <div id="fixed"></div>\n        </div>\n    </div>',document.querySelector("body").appendChild(e),document.querySelector(".cp-container .cp-image").src=chrome.runtime.getURL("logo.svg"),document.querySelector(".cp-container .cp-pickimage").src=chrome.runtime.getURL("pickicon.svg"),document.querySelector(".cp-header button").addEventListener("click",(async()=>{await n(),await new Promise((e=>setTimeout(e,100))),chrome.runtime.sendMessage({captureScreen:!0},(function(e){}))}))})())}))})();